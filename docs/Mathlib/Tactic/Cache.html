<html lang="en"><head><meta charset="UTF-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><link rel="stylesheet" href="../.././style.css"></link><link rel="stylesheet" href="../.././src/pygments.css"></link><link rel="shortcut icon" href="../.././favicon.ico"></link><link rel="prefetch" href="../.././/declarations/declaration-data.bmp" as="image"></link><title>Mathlib.Tactic.Cache</title><script defer="true" src="../.././mathjax-config.js"></script><script defer="true" src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script defer="true" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>const SITE_ROOT="../.././";</script><script>const MODULE_NAME="Mathlib.Tactic.Cache";</script><script type="module" src="../.././search.js"></script><script type="module" src="../.././how-about.js"></script><script type="module" src="../.././instances.js"></script><script type="module" src="../.././importedBy.js"></script></head><body><input id="nav_toggle" type="checkbox"></input><header><h1><label for="nav_toggle"></label>Documentation</h1><p class="header_filename break_within"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span></p><form action="https://google.com/search" method="get" id="search_form"><input type="hidden" name="sitesearch" value="https://leanprover-community.github.io/mathlib4_docs"></input><input type="text" name="q" autocomplete="off"></input>&#32;
            <button id="search_button" onclick="javascript: form.action='../.././search.html';">Search</button><button>Google site search</button></form></header><nav class="internal_nav"><h3><a class="break_within" href="#top"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span></a></h3><p class="gh_nav_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean">source</a></p><div class="imports"><details><summary>Imports</summary><ul><li><a href="../.././Init.html">Init</a></li><li><a href="../.././Lean.html">Lean</a></li><li><a href="../.././Mathlib/Logic/Nonempty.html">Mathlib.Logic.Nonempty</a></li><li><a href="../.././Mathlib/Lean/Meta/DiscrTree.html">Mathlib.Lean.Meta.DiscrTree</a></li></ul></details><details><summary>Imported by</summary><ul id="imported-by-Mathlib.Tactic.Cache" class="imported-by-list"></ul></details></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.Cache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.instNonemptyCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyCache</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.Cache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span>.<span class="name">mk</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.Cache.get"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span>.<span class="name">get</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DeclCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.instNonemptyDeclCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyDeclCache</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DeclCache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span>.<span class="name">mk</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DeclCache.get"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span>.<span class="name">get</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DiscrTreeCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DiscrTreeCache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span>.<span class="name">mk</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.DiscrTreeCache.getMatch"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span>.<span class="name">getMatch</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.CachedData"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">CachedData</span></a></div><div class="nav_link"><a class="break_within" href="#Mathlib.Tactic.instNonemptyCachedData"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyCachedData</span></a></div></nav><main>
<div class="mod_doc"><h1 class="markdown-heading" id="Once-per-file-cache-for-tactics">Once-per-file cache for tactics <a class="hover-link" href="#Once-per-file-cache-for-tactics">#</a></h1><p>This file defines cache data structures for tactics
that are initialized the first time they are accessed.
Since Lean 4 starts one process per file,
these caches are once-per-file
and can for example be used to cache information
about the imported modules.</p><p>The <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Cache</a> α</code> data structure is
the most generic version we define.
It is created using <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.mk">Cache.mk</a> f</code>
where <code>f : MetaM α</code> performs
the initialization of the cache:</p><pre><code>initialize numberOfImports : <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Cache</a> <a href="../.././Init/Prelude.html#Nat">Nat</a> ← <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.mk">Cache.mk</a> do
  (← getEnv).imports.size

-- (does <a href="../.././Init/Prelude.html#not">not</a> work in the same module where the <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.cache">cache</a> is defined)
#eval show MetaM <a href="../.././Init/Prelude.html#Nat">Nat</a> from numberOfImports.<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.get">get</a>
</code></pre><p>The <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">DeclCache</a> α</code> data structure computes
a fold over the environment's constants:
<code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.mk">DeclCache.mk</a> empty f</code> constructs such a cache
where <code>empty : α</code> and <code>f : Name → ConstantInfo → α → MetaM α</code>.
The result of the constants in the imports is cached
between tactic invocations,
while for constants defined in the same file
<code>f</code> is evaluated again every time.
This kind of cache can be used e.g.
to populate discrimination trees.</p></div><div class="decl" id="Mathlib.Tactic.Cache"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L50-L52">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>Once-per-file cache.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Mathlib.Tactic.Cache</a> <span class="fn">α</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/System/IO.html#IO.Ref">IO.Ref</a> (<span class="fn"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span> <a href="../.././Init/Core.html#Sum">⊕</a> <span class="fn"><a href="../.././Init/Core.html#Task">Task</a> (<span class="fn"><a href="../.././Init/Prelude.html#Except">Except</a> <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a> <span class="fn">α</span></span>)</span></span>)</span></span></li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.Cache" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.instNonemptyCache"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L54-L55">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyCache</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Mathlib.Tactic.Cache</a> <span class="fn">α</span></span>)</span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCache">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCache">Mathlib.Tactic.instNonemptyCache</a></a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCache.proof_1">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCache.proof_1">Mathlib.Tactic.instNonemptyCache.proof_1</a></a></span></li></ul></details></div></div><div class="decl" id="Mathlib.Tactic.Cache.mk"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L58-L59">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span>.<span class="name">mk</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(init : <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Mathlib.Tactic.Cache</a> <span class="fn">α</span></span>)</span></div></div><p>Creates a cache with an initialization function.</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.mk">Mathlib.Tactic.Cache.mk</a> <span class="fn">init</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Init/Prelude.html#liftM">liftM</a> (<span class="fn"><a href="../.././Init/System/IO.html#IO.mkRef">IO.mkRef</a> (<span class="fn"><a href="../.././Init/Core.html#Sum.inl">Sum.inl</a> <span class="fn">init</span></span>)</span>)</span></span></li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.Cache.mk" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.Cache.get"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L67-L91">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.get"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">Cache</span>.<span class="name">get</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{m : <span class="fn"><a href="../.././foundational_types.html">Type</a> → <a href="../.././foundational_types.html">Type</a></span>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Init/Prelude.html#Monad">Monad</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Lean/Environment.html#Lean.MonadEnv">Lean.MonadEnv</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Lean/Log.html#Lean.MonadLog">Lean.MonadLog</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Lean/Data/Options.html#Lean.MonadOptions">Lean.MonadOptions</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Init/Prelude.html#MonadLiftT">MonadLiftT</a> <a href="../.././Init/System/IO.html#BaseIO">BaseIO</a> <span class="fn">m</span></span>]</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Init/Prelude.html#MonadExcept">MonadExcept</a> <a href="../.././Lean/Exception.html#Lean.Exception">Lean.Exception</a> <span class="fn">m</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(cache : <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Mathlib.Tactic.Cache</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><span class="fn">m</span> <span class="fn">α</span></span></div></div><p>Access the cache.
Calling this function for the first time
will initialize the cache with the function
provided in the constructor.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.Cache.get" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DeclCache"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L97-L105">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_ext"><li id="Mathlib.Tactic.DeclCache.mk'" class="structure_ext_ctor">mk' :: (</li><ul class="structure_ext_fields"><li id="Mathlib.Tactic.DeclCache.cache" class="structure_field"><div class="structure_field_doc"><p>The cached data.</p></div><div class="structure_field_info">cache : <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache">Mathlib.Tactic.Cache</a> <span class="fn">α</span></span></div></li><li id="Mathlib.Tactic.DeclCache.addDecl" class="structure_field"><div class="structure_field_doc"><p>Function for adding a declaration from the current file to the cache.</p></div><div class="structure_field_info">addDecl : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> → <span class="fn"><a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a> → <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span></span></span></div></li><li id="Mathlib.Tactic.DeclCache.addLibraryDecl" class="structure_field"><div class="structure_field_doc"><p>Function for adding a declaration from the library to the cache.
Defaults to the same behaviour as adding a declaration from the current file.</p></div><div class="structure_field_info">addLibraryDecl : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> → <span class="fn"><a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a> → <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span></span></span></div></li></ul><li class="structure_ext_ctor">)</li></ul><p>Cached fold over the environment's declarations,
where a given function is applied to <code>α</code> for every constant.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DeclCache" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.instNonemptyDeclCache"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L105-L105">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyDeclCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyDeclCache</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∀ {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>} [<span class="fn">inst</span> : <span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> <span class="fn">α</span></span>], <span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">Mathlib.Tactic.DeclCache</a> <span class="fn">α</span></span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyDeclCache">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyDeclCache">Mathlib.Tactic.instNonemptyDeclCache</a></a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyDeclCache.proof_1">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyDeclCache.proof_1">Mathlib.Tactic.instNonemptyDeclCache.proof_1</a></a></span></li></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DeclCache.mk"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L114-L124">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span>.<span class="name">mk</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(profilingName : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(empty : <span class="fn">α</span>)</span></span>
<span class="decl_args">
<span class="fn">(addDecl : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> → <span class="fn"><a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a> → <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(addLibraryDecl : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> (<span class="fn"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> → <span class="fn"><a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a> → <span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span></span></span>) <span class="fn">addDecl</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(post : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> (<span class="fn"><span class="fn">α</span> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></span>) <span class="fn">fun <span class="fn">a</span> =&gt <span class="fn"><a href="../.././Init/Prelude.html#Pure.pure">pure</a> <span class="fn">a</span></span></span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">Mathlib.Tactic.DeclCache</a> <span class="fn">α</span></span>)</span></div></div><p>Creates a <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">DeclCache</a></code>.
The cached structure <code>α</code> is initialized with <code>empty</code>,
and then <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.addLibraryDecl">addLibraryDecl</a></code> is called for every imported constant, and the result is cached.
After all imported constants have been added, we run <code>post</code>.
When <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.get">get</a></code> is called, <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.addDecl">addDecl</a></code> is also called for every constant in the current file.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DeclCache.mk" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DeclCache.get"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L132-L136">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache.get"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DeclCache</span>.<span class="name">get</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(cache : <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">Mathlib.Tactic.DeclCache</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> <span class="fn">α</span></span></div></div><p>Access the cache.
Calling this function for the first time
will initialize the cache with the function
provided in the constructor.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DeclCache.get" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DiscrTreeCache"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L143-L144">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><p>A type synonym for a <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">DeclCache</a></code> containing a pair of discrimination trees.
The first will store declarations in the current file,
the second will store declarations from imports (and will hopefully be "read-only" after creation).</p><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache">Mathlib.Tactic.DiscrTreeCache</a> <span class="fn">α</span></span> <a href="../.././Init/Prelude.html#Eq">=</a> <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DeclCache">Mathlib.Tactic.DeclCache</a> (<span class="fn"><span class="fn"><a href="../.././Lean/Meta/DiscrTreeTypes.html#Lean.Meta.DiscrTree">Lean.Meta.DiscrTree</a> <span class="fn">α</span> <a href="../.././Init/Prelude.html#Bool.true">true</a></span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn"><a href="../.././Lean/Meta/DiscrTreeTypes.html#Lean.Meta.DiscrTree">Lean.Meta.DiscrTree</a> <span class="fn">α</span> <a href="../.././Init/Prelude.html#Bool.true">true</a></span></span>)</span></span></li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DiscrTreeCache" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DiscrTreeCache.mk"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L150-L166">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache.mk"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span>.<span class="name">mk</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="impl_arg"><span class="decl_args">
<span class="fn">[inst : <span class="fn"><a href="../.././Init/Prelude.html#BEq">BEq</a> <span class="fn">α</span></span>]</span></span>
</span><span class="decl_args">
<span class="fn">(profilingName : <a href="../.././Init/Prelude.html#String">String</a>)</span></span>
<span class="decl_args">
<span class="fn">(processDecl : <span class="fn"><a href="../.././Init/Prelude.html#Lean.Name">Lean.Name</a> → <span class="fn"><a href="../.././Lean/Declaration.html#Lean.ConstantInfo">Lean.ConstantInfo</a> → <span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> (<span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> (<span class="fn"><a href="../.././Lean/Meta/DiscrTreeTypes.html#Lean.Meta.DiscrTree.Key">Lean.Meta.DiscrTree.Key</a> <a href="../.././Init/Prelude.html#Bool.true">true</a></span>)</span> <a href="../.././Init/Prelude.html#Prod">×</a> <span class="fn">α</span></span>)</span>)</span></span></span>)</span></span>
<span class="decl_args">
<span class="fn">(post? : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> (<span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> (<span class="fn"><span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span> → <span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span></span>)</span>) <span class="fn">none</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(init : <span class="fn"><a href="../.././Init/Prelude.html#optParam">optParam</a> (<span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> (<span class="fn"><a href="../.././Lean/Meta/DiscrTreeTypes.html#Lean.Meta.DiscrTree">Lean.Meta.DiscrTree</a> <span class="fn">α</span> <a href="../.././Init/Prelude.html#Bool.true">true</a></span>)</span>) <span class="fn">none</span></span>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Init/System/IO.html#IO">IO</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache">Mathlib.Tactic.DiscrTreeCache</a> <span class="fn">α</span></span>)</span></div></div><p>Build a <code><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache">DiscrTreeCache</a></code>,
from a function that returns a collection of keys and values for each declaration.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DiscrTreeCache.mk" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.DiscrTreeCache.getMatch"><div class="def"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L177-L181">source</a></div><div class="decl_header"><span class="decl_kind">def</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache.getMatch"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">DiscrTreeCache</span>.<span class="name">getMatch</span></a></span><span class="impl_arg"><span class="decl_args">
<span class="fn">{α : <a href="../.././foundational_types.html">Type</a>}</span></span>
</span><span class="decl_args">
<span class="fn">(c : <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache">Mathlib.Tactic.DiscrTreeCache</a> <span class="fn">α</span></span>)</span></span>
<span class="decl_args">
<span class="fn">(e : <a href="../.././Lean/Expr.html#Lean.Expr">Lean.Expr</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><span class="fn"><a href="../.././Lean/Meta/Basic.html#Lean.Meta.MetaM">Lean.MetaM</a> (<span class="fn"><a href="../.././Init/Prelude.html#Array">Array</a> <span class="fn">α</span></span>)</span></div></div><p>Get matches from both the discrimination tree for declarations in the current file,
and for the imports.</p><p>Note that if you are calling this multiple times with the same environment,
it will rebuild the discrimination tree for the current file multiple times,
and it would be more efficient to call <code>c.<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.Cache.get">get</a></code> once,
and then call <code>DiscrTree.<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache.getMatch">getMatch</a></code> multiple times.</p><details><summary>Equations</summary><ul class="equations"><li class="equation">One or more equations did not get rendered due to their size.</li></ul></details><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.DiscrTreeCache.getMatch" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.CachedData"><div class="structure"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L187-L190">source</a></div><div class="decl_header"><span class="decl_kind">structure</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.CachedData"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">CachedData</span></a></span><span class="decl_args">
<span class="fn">(α : <a href="../.././foundational_types.html">Type</a>)</span></span>
<span class="decl_args"> :</span><div class="decl_type"><a href="../.././foundational_types.html">Type</a></div></div><ul class="structure_fields" id="Mathlib.Tactic.CachedData.mk"><li id="Mathlib.Tactic.CachedData.pointer?" class="structure_field"><div class="structure_field_info">pointer? : <span class="fn"><a href="../.././Init/Prelude.html#Option">Option</a> <a href="../.././Lean/Environment.html#Lean.CompactedRegion">Lean.CompactedRegion</a></span></div></li><li id="Mathlib.Tactic.CachedData.cache" class="structure_field"><div class="structure_field_info">cache : <span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.DiscrTreeCache">Mathlib.Tactic.DiscrTreeCache</a> <span class="fn">α</span></span></div></li></ul><p>A structure that holds the cached discrimination tree,
and possibly a pointer to a memory region, if we unpickled the tree from disk.</p><details class="instances"><summary>Instances For</summary><ul id="instances-for-list-Mathlib.Tactic.CachedData" class="instances-for-list"></ul></details></div></div><div class="decl" id="Mathlib.Tactic.instNonemptyCachedData"><div class="instance"><div class="gh_link"><a href="https://github.com/leanprover-community/mathlib4/blob/44c828ca5b12983ef1d4eea5c54f95c2ef52cb36/Mathlib/Tactic/Cache.lean#L190-L190">source</a></div><div class="decl_header"><span class="decl_kind">instance</span>
<span class="decl_name"><a class="break_within" href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCachedData"><span class="name">Mathlib</span>.<span class="name">Tactic</span>.<span class="name">instNonemptyCachedData</span></a></span><span class="decl_args"> :</span><div class="decl_type"><span class="fn">∀ {<span class="fn">α</span> : <a href="../.././foundational_types.html">Type</a>}, <span class="fn"><a href="../.././Init/Prelude.html#Nonempty">Nonempty</a> (<span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.CachedData">Mathlib.Tactic.CachedData</a> <span class="fn">α</span></span>)</span></span></div></div><details><summary>Equations</summary><ul class="equations"><li class="equation"><span class="fn"><a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCachedData">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCachedData">Mathlib.Tactic.instNonemptyCachedData</a></a> <a href="../.././Init/Prelude.html#Eq">=</a> <a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCachedData.proof_1">@<a href="../.././Mathlib/Tactic/Cache.html#Mathlib.Tactic.instNonemptyCachedData.proof_1">Mathlib.Tactic.instNonemptyCachedData.proof_1</a></a></span></li></ul></details></div></div></main>
<nav class="nav"><iframe src="../.././navbar.html" class="navframe" frameBorder="0"></iframe></nav></body></html>